<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>WCPG CRM</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    html, body { height: 100%; }
    body { @apply bg-slate-100 dark:bg-zinc-950 text-slate-900 dark:text-slate-100 font-sans; }
    /* UI Primitives */
    .btn { @apply inline-flex items-center gap-2 px-3 py-2 rounded-md border border-slate-300 dark:border-zinc-700 bg-white dark:bg-zinc-800 hover:bg-slate-50 dark:hover:bg-zinc-700 text-sm transition; }
    .btn-primary { @apply bg-sky-600 text-white border-sky-600 hover:bg-sky-700; }
    .input, select, textarea { @apply bg-white dark:bg-zinc-900 border border-slate-300 dark:border-zinc-700 px-3 py-2 rounded-md text-sm w-full; }
    .card { @apply bg-white dark:bg-zinc-900 border border-slate-200 dark:border-zinc-800 rounded-md shadow-sm; }
    .toolbar { @apply flex items-center justify-between gap-3 p-3 border-b border-slate-200 dark:border-zinc-800; }
    table { @apply w-full border-collapse text-sm; }
    th, td { @apply border-b border-slate-200 dark:border-zinc-800 px-3 py-2; }
    th { @apply bg-slate-50 dark:bg-zinc-800 text-left font-semibold; }
    tr:hover td { @apply bg-slate-100/70 dark:bg-zinc-800 transition-colors; }
    .chip { @apply text-xs px-2 py-0.5 rounded-md font-medium; }
    .chip-open { @apply bg-amber-100 text-amber-800 dark:bg-amber-500/20 dark:text-amber-200; }
    .chip-won { @apply bg-emerald-100 text-emerald-800 dark:bg-emerald-500/20 dark:text-emerald-200; }
    .chip-lost { @apply bg-rose-100 text-rose-800 dark:bg-rose-500/20 dark:text-rose-200; }
    .dropdown { @apply relative inline-block text-left; }
    .dropdown-menu { @apply absolute right-0 mt-2 w-40 origin-top-right bg-white dark:bg-zinc-800 border border-slate-200 dark:border-zinc-700 rounded-md shadow-lg hidden; }
    .dropdown-menu button { @apply w-full text-left px-4 py-2 text-sm hover:bg-slate-100 dark:hover:bg-zinc-700; }
    .dropdown.open .dropdown-menu { @apply block; }
  </style>
</head>
<body class="min-h-full">
  <!-- Top Bar -->
  <header class="sticky top-0 z-40 bg-white/90 dark:bg-zinc-900/90 backdrop-blur supports-[backdrop-filter]:bg-white/80 border-b border-slate-200 dark:border-zinc-800">
    <div class="max-w-screen-2xl mx-auto px-4">
      <div class="h-14 flex items-center justify-between">
        <div class="flex items-center gap-3">
          <div class="w-8 h-8 rounded-md bg-sky-600"></div>
          <div>
            <div class="font-bold leading-tight">WCPG CRM</div>
            <div class="text-xs text-slate-500 dark:text-slate-400">Leads • Deals • Inventory</div>
          </div>
        </div>
        <div class="flex items-center gap-2">
          <button class="btn" title="Search" aria-label="Search">
            <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="7"/><path d="m21 21-4.3-4.3"/></svg>
          </button>
          <select id="themeSelect" class="input w-[120px]">
            <option value="system">System</option>
            <option value="light" selected>Light</option>
            <option value="dark">Dark</option>
          </select>
          <div class="dropdown">
            <button class="btn" onclick="toggleDropdown(this)">
              <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
              <span class="hidden sm:inline">Account</span>
            </button>
            <div class="dropdown-menu">
              <button id="signInBtn">Sign in</button>
              <button id="signOutBtn" class="hidden">Sign out</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>

  <!-- App Shell -->
  <div class="max-w-screen-2xl mx-auto px-4">
    <div class="grid grid-cols-12 gap-4 py-4">
      <!-- Sidebar -->
      <aside class="col-span-12 md:col-span-3 lg:col-span-2">
        <nav class="card overflow-hidden">
          <div class="px-3 py-2 text-xs font-semibold tracking-wide text-slate-500 dark:text-slate-400 border-b border-slate-200 dark:border-zinc-800">Modules</div>
          <ul id="sideNav" class="p-2">
            <li><button data-tab="leads" class="side-link w-full flex items-center gap-3 px-3 py-2 rounded-md hover:bg-slate-100 dark:hover:bg-zinc-800 active">
              <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M16 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
              Leads</button></li>
            <li><button data-tab="deals" class="side-link w-full flex items-center gap-3 px-3 py-2 rounded-md hover:bg-slate-100 dark:hover:bg-zinc-800">
              <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="7" width="20" height="14" rx="2"/><path d="M16 3v4"/><path d="M8 3v4"/></svg>
              Deals</button></li>
            <li><button data-tab="inventory" class="side-link w-full flex items-center gap-3 px-3 py-2 rounded-md hover:bg-slate-100 dark:hover:bg-zinc-800">
              <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 7h18"/><path d="M3 12h18"/><path d="M3 17h18"/></svg>
              Inventory</button></li>
            <li><button data-tab="metrics" class="side-link w-full flex items-center gap-3 px-3 py-2 rounded-md hover:bg-slate-100 dark:hover:bg-zinc-800">
              <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 3v18h18"/><path d="M7 13v5"/><path d="M12 9v9"/><path d="M17 5v13"/></svg>
              Metrics</button></li>
            <li><button data-tab="admin" class="side-link w-full flex items-center gap-3 px-3 py-2 rounded-md hover:bg-slate-100 dark:hover:bg-zinc-800">
              <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 1 1-4 0v-.09A1.65 1.65 0 0 0 8 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06A2 2 0 1 1 3.29 17l.06-.06a1.65 1.65 0 0 0 .33-1.82A1.65 1.65 0 0 0 2 14H2a2 2 0 1 1 0-4h.09A1.65 1.65 0 0 0 3.6 8a1.65 1.65 0 0 0-.33-1.82l-.06-.06A2 2 0 1 1 6.04 3.29l.06.06A1.65 1.65 0 0 0 7.92 3h.18A1.65 1.65 0 0 0 9.6 2.49V2a2 2 0 1 1 4 0v.09A1.65 1.65 0 0 0 15 3.6c.38 0 .74.15 1.01.42l.06.06A2 2 0 1 1 19.71 6l-.06.06A1.65 1.65 0 0 0 20.4 8c0 .2-.03.39-.09.58"/></svg>
              Admin</button></li>
          </ul>
        </nav>
      </aside>

      <!-- Main Content -->
      <section class="col-span-12 md:col-span-9 lg:col-span-10 space-y-4" id="contentRoot">
        <!-- Leads -->
        <div id="view-leads" class="card overflow-hidden">
          <div class="toolbar">
            <div class="flex items-center gap-2">
              <h2 class="text-base font-semibold">Leads</h2>
              <span class="chip chip-open">Open</span>
            </div>
            <div class="flex items-center gap-2">
              <input id="leadSearch" class="input w-64" placeholder="Search leads…" />
              <button class="btn-primary" id="toggleLeadFormBtn">+ New Lead</button>
            </div>
          </div>
          <div id="leadFormWrap" class="px-4 py-3 border-b border-slate-200 dark:border-zinc-800 hidden">
            <div class="grid grid-cols-2 gap-3">
              <input id="lead_name" class="input" placeholder="Name" />
              <input id="lead_phone" class="input" placeholder="Phone" />
              <input id="lead_email" class="input" placeholder="Email" />
              <input id="lead_source" class="input" placeholder="Source (Walk-in, Web, Call)" />
              <input id="lead_interest" class="input col-span-2" placeholder="Interested in (brand/model)" />
              <select id="lead_owner" class="input col-span-2"></select>
              <textarea id="lead_notes" class="input col-span-2" placeholder="Notes"></textarea>
            </div>
            <div class="mt-3 flex justify-end gap-2">
              <button id="saveLeadBtn" class="btn-primary">Save Lead</button>
              <button id="cancelLeadBtn" class="btn">Cancel</button>
            </div>
          </div>
          <div class="overflow-auto">
            <table>
              <thead>
                <tr><th>Name</th><th>Phone</th><th>Email</th><th>Interest</th><th class="w-1">Actions</th></tr>
              </thead>
              <tbody id="leadBody">
                <tr>
                  <td>John Doe</td><td>555-1234</td><td>john@example.com</td><td>Yamaha C3</td>
                  <td>
                    <div class="dropdown">
                      <button class="btn" onclick="toggleDropdown(this)" aria-haspopup="menu" aria-expanded="false">⋮</button>
                      <div class="dropdown-menu" role="menu">
                        <button onclick="editLead('1')">Edit</button>
                        <button onclick="convertLead('1')">Convert to Deal</button>
                        <button onclick="deleteLead('1')">Delete</button>
                      </div>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- Deals -->
        <div id="view-deals" class="card overflow-hidden hidden">
          <div class="toolbar"><h2 class="text-base font-semibold">Deals</h2><input id="dealSearch" class="input w-64" placeholder="Search deals…" /></div>
          <div class="overflow-auto">
            <table>
              <thead><tr><th>Title</th><th>Status</th><th>Buyer</th><th>Amount</th></tr></thead>
              <tbody id="dealBody"><tr><td>Yamaha C3</td><td><span class="chip chip-won">Closed Won</span></td><td>John Doe</td><td>$12,000</td></tr></tbody>
            </table>
          </div>
        </div>

        <!-- Inventory -->
        <div id="view-inventory" class="card overflow-hidden hidden">
          <div class="toolbar"><h2 class="text-base font-semibold">Inventory</h2><input id="invSearch" class="input w-64" placeholder="Search inventory…" /></div>
          <div class="overflow-auto">
            <table>
              <thead><tr><th>Brand</th><th>Model</th><th>Serial</th><th>Price</th></tr></thead>
              <tbody id="invBody"><tr><td>Baldwin</td><td>R1</td><td>123456</td><td>$8,500</td></tr></tbody>
            </table>
          </div>
        </div>

        <!-- Metrics -->
        <div id="view-metrics" class="hidden grid md:grid-cols-2 gap-4">
          <div class="card"><div class="toolbar"><h2 class="text-base font-semibold">Pipeline Overview</h2></div><div id="pipelineStats" class="p-4 grid grid-cols-2 gap-2 text-sm"></div></div>
          <div class="card"><div class="toolbar"><h2 class="text-base font-semibold">Performance by Salesperson</h2></div><div id="repStats" class="p-4 space-y-2 text-sm"></div></div>
          <div class="card md:col-span-2"><div class="toolbar"><h2 class="text-base font-semibold">Recent Activity</h2></div><div id="activityFeed" class="p-4 space-y-2 text-sm"></div></div>
        </div>

        <!-- Admin -->
        <div id="view-admin" class="card overflow-hidden hidden">
          <div class="toolbar"><h2 class="text-base font-semibold">Admin</h2></div>
          <div class="p-4 grid md:grid-cols-2 gap-4">
            <div class="card">
              <div class="toolbar"><h3 class="font-semibold">Salespeople</h3></div>
              <div class="p-4 space-y-3">
                <div class="flex items-center gap-2">
                  <input id="newRepName" class="input" placeholder="Name" />
                  <input id="newRepEmail" class="input" placeholder="Email" />
                  <button id="addRepBtn" class="btn-primary">Add</button>
                </div>
                <ul id="repList" class="space-y-2 text-sm"></ul>
              </div>
            </div>
            <div class="card">
              <div class="toolbar"><h3 class="font-semibold">Integrations</h3></div>
              <div class="p-4">
                <p class="text-sm opacity-80 mb-2">Paste a call log or webhook payload for caller matching.</p>
                <textarea id="callersPaste" class="input h-32" placeholder="timestamp, callerId, note"></textarea>
                <button id="importCallsBtn" class="btn mt-2">Import Call Log</button>
              </div>
            </div>
          </div>
        </div>
      </section>
    </div>
  </div>

  <footer class="mt-4 text-center text-xs text-slate-500 dark:text-slate-400 py-4">© 2025 WCPG CRM — Zoho-inspired interface.</footer>

  <script>
    // Theme
    const themeSelect = document.getElementById('themeSelect');
    function applyTheme(val){
      if(val==='dark' || (val==='system' && window.matchMedia('(prefers-color-scheme: dark)').matches)){
        document.documentElement.classList.add('dark');
      } else { document.documentElement.classList.remove('dark'); }
      localStorage.setItem('wcpg_theme', val);
    }
    themeSelect.value = localStorage.getItem('wcpg_theme')||'light';
    applyTheme(themeSelect.value);
    themeSelect.addEventListener('change', e=>applyTheme(e.target.value));

    // Sidebar nav routing
    const views = {
      leads: document.getElementById('view-leads'),
      deals: document.getElementById('view-deals'),
      inventory: document.getElementById('view-inventory'),
      metrics: document.getElementById('view-metrics'),
      admin: document.getElementById('view-admin'),
    };
    document.getElementById('sideNav').addEventListener('click', (e)=>{
      const btn = e.target.closest('button[data-tab]'); if(!btn) return;
      const tab = btn.dataset.tab;
      document.querySelectorAll('#sideNav .side-link').forEach(b=>b.classList.remove('active','bg-slate-100','dark:bg-zinc-800'));
      btn.classList.add('active','bg-slate-100','dark:bg-zinc-800');
      Object.values(views).forEach(v=>v.classList.add('hidden'));
      views[tab].classList.remove('hidden');
    });

    // Dropdowns
    function toggleDropdown(btn){ btn.parentElement.classList.toggle('open'); }
    window.toggleDropdown = toggleDropdown;

    // Lead form
    const leadFormWrap = document.getElementById('leadFormWrap');
    document.getElementById('toggleLeadFormBtn').onclick = ()=>{
      leadFormWrap.classList.toggle('hidden');
    }
    document.getElementById('cancelLeadBtn').onclick = ()=> leadFormWrap.classList.add('hidden');

    // Placeholder lead actions
    window.editLead = id=>alert('Edit lead '+id);
    window.convertLead = id=>alert('Convert lead '+id+' to deal');
    window.deleteLead = id=>confirm('Delete this lead?') && alert('Deleted lead '+id);
  </script>
</body>
</html>
